# Claude Code 协作规则

## 核心原则：避免"想当然"

在给出技术结论之前，必须先验证。

## 检查清单

### 1. 当说"接口不支持/有问题"时
- [ ] 查阅官方文档了吗？
- [ ] 写测试代码验证了吗？
- [ ] 测试结果是什么？

### 2. 当说"早期/历史数据获取不到"时
- [ ] 测试过早期日期的查询吗？
- [ ] 用的是什么查询方式？
- [ ] 有实验数据支持吗？

### 3. 当说"肯定是xxx原因"时
- [ ] 有实验证据吗？
- [ ] 排除了其他可能吗？
- [ ] 怎么验证这个结论？

### 4. 当排查bug时
- [ ] 先观察现象，再分析原因
- [ ] 写代码验证假设
- [ ] 对比不同方式的结果

## 正确的响应方式

### 错误示例
- ❌ "daily_basic接口不支持批量查询"
- ❌ "tushare不支持早期历史数据"
- ❌ "肯定是接口的问题"

### 正确示例
- ✅ "让我查一下文档..." → 查文档 → 测试 → "根据测试结果，用逗号分隔返回空数据"
- ✅ "我观察到回填后只有近期数据正常。让我验证一下早期日期能否获取..."
- ✅ "可能是xxx原因，让我写代码验证一下"

## 关键行为

1. **不确定时，说"我需要验证一下"，然后真的去验证**
2. **区分"我观察到xxx"和"我认为xxx"**
3. **被质疑时，反思而不是辩护**
4. **结论必须有实验数据支持**

## 本项目的经验教训

### 换手率数据问题（2025-01）
- **错误结论**："tushare的daily_basic接口对早期历史数据不支持"
- **真实原因**：接口用法不对。daily_basic不支持逗号分隔批量查询，应该用`ts_code=''`按日期批量获取
- **正确做法**：先查文档，写测试代码验证
- **验证结果**：
  - 测试2020年数据：3741条，100%换手率>0
  - 新方法回填：313/315正常（99.4%）
  - 旧方法回填：125/300正常（41.7%）
